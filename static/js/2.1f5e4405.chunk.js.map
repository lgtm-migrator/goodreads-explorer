{"version":3,"sources":["assets/images/good_reads_explorer.png","components/NetworkGraph/examples/basic/tiny_grid.png","components/UserProfile/index.jsx","components/NetworkGraph/components/Node/index.js","components/NetworkGraph/components/Link/index.js","components/NetworkGraph/components/Universe/index.js","components/NetworkGraph/index.js","components/BookCover/index.jsx","components/BookLibrary/index.jsx","components/Settings/index.js","components/ErrorBoundary/index.jsx","utils/graphHelper.js","containers/Dashboard/index.jsx"],"names":["module","exports","__webpack_require__","p","Meta","Card","UserProfile","props","react_default","a","createElement","card","bordered","className","avatar","src","user","image","size","title","href","link","target","rel","name","description","length","concat","slice","Node","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","clickHandler","bind","assertThisInitialized","doubleClickHandler","mouseOverHandler","mouseOutHandler","clickTimeout","onClick","type","data","id","onDoubleClick","event","x","onMouseOver","text","onMouseOut","_this$props","radius","color","y","style","active","transform","cursor","opacity","r","fill","getThumbnail","Component","img","shortText","textStyle","xlinkHref","clipPath","width","dx","dy","fontSize","defaultProps","stroke","strokeWidth","fontWeight","Link","d","pointer","getPointer","markerEnd","getLabel","viewBox","refX","arrowOffset","refY","markerWidth","markerHeight","orient","startOffset","pointerEvents","textAnchor","Universe","state","objectSpread","getArcPath","getLinks","nextProps","setState","source","links","filter","map","l","scale","sweep","clockwise","arguments","undefined","x1","y1","x2","y2","siblings","linkIdx","scaleOrdinal","domain","range","arcScale","dr","Math","sqrt","_this2","_this$state","nodes","reduce","acc","idx","push","components_Link","key","node","components_Node","assign","NetworkGraph","selectedNode","activeNodes","simulation","initSimulation","height","k","tooltip","top","left","initZoomHandler","updateSimulation","onTick","svg","React","createRef","interval","fps","millis","Date","now","getNeighborNodes","current","clientWidth","clientHeight","newProps","_this3","linkForce","forceLink","strength","distance","forceSimulation","force","_this4","select","zoomHandler","zoom","on","_this5","attraceForceStrength","chargeStrength","collisionRadiusOffset","collisionStrength","animation","velocityDecay","alphaStart","cluster","clusterRadiusScale","forEach","sourceNode","targetNode","forceCenter","forceManyBody","forceCollide","clusters","uniqBy","arr","cos","PI","random","sin","alpha","applyClusterForce","alphaTarget","restart","tick","e","currentTime","payload","clientY","clientX","neighbors","_this$state2","indexOf","ref","components_Universe","vx","vy","backgroundColor","overflow","position","imgStyle","transition","BookCover","_ref","index","photo","margin","direction","lib_default","alt","BookLibrary","react_photo_gallery_esm","photos","books","book","small_image_url","replace","str","tmp","split","obj","window","open","columns","ImageComponent","CheckboxGroup","Checkbox","Group","plainOptions","Settings","defaultOptions","option","settings","updateState","updateFps","updateCluster","updateAnimation","updateAlphaStart","updateVelocityDecay","updateChargeStrength","updateCollisionStrength","updateClusterRadiusScale","updateCollisionRadiusOffset","updateAttracForceStrength","val","onChange","_this$state$settings","borderBottom","padding","options","value","checked","es_tooltip","placement","slider","defaultValue","max","min","step","onAfterChange","es_button","onReset","block","ErrorBoundary","hasError","error","info","console","log","children","minifyString","word","charAt","toUpperCase","join","SubMenu","Menu","Content","Layout","Sider","TreeNode","Tree","mapDispatchToProps","getUserInfo","getUserData","defaultGraphSettings","Dashboard","localStorage","getItem","selectedShelf","selectedShelves","selectedMenu","graphSettings","JSON","parse","onSelect","onCheck","onSettingsChange","onSettingsReset","match","params","userId","selectedKeys","checkedKeys","setItem","stringify","removeItem","location","reload","userData","components_ErrorBoundary","layout","background","es_Link","to","goodReadsLogo","getUserComponent","getMenu","breadcrumb","Item","backgroundImage","bgImage","getContent","context","_context$state","_getGraphData","shelves","bookNodes","authorNodes","publisherNodes","user_shelves","shelf","property","author","authors","$t","image_url","publisher","sourceType","targetType","publicationYear","publication_year","publicationMonth","publication_month","publicationDay","publication_day","values","getGraphData","components_NetworkGraph","getBookLibrary","components_UserProfile","userName","user_name","about","last_active","menu","mode","defaultOpenKeys","borderRight","theme","icon","tree","checkable","published","disableCheckbox","disabled","components_Settings","bookShelf","find","sh","components_BookLibrary","connect","userInfo","dashboard"],"mappings":"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","file":"static/js/2.1f5e4405.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/good_reads_explorer.eff85db6.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAAAAACMIRMSAAAAmElEQVR4AX2RwQ4EIQhD/f9ftYW7p6U0buYiEmLG5fGUXRlELda2eyEJ6mDFea36Kf8RZ1egUjFTOFTtn4RSFN6Uu7Pq0bu7iFx8U/ZEh3yyyEk1fFIy+CXiXB+Ve3TdGVxuN6XTeRo0Y6d38aMLH8ZvtBXjDK/BtayAreM0dBdXZqcsdq+cJv/9f/3l286UK68zZVKX6V0/HECKK51+49AAAAAASUVORK5CYII=\"","import React from 'react'\n\n// antd components\nimport { Avatar, Card } from 'antd'\n\nimport './style.css'\n\nconst { Meta } = Card\n\nconst UserProfile = props => (\n  <Card\n    bordered={false}\n    className='userCard'\n  >\n    <Meta\n      avatar={\n        <Avatar src={props.user.image} size='large' />\n      }\n      title={\n        <a\n          href={props.user.link}\n          target='_blank'\n          rel='noopener noreferrer'\n        >\n          {props.user.name}\n        </a>\n      }\n      description={\n        props.user.description.length > 160\n          ? `${props.user.description.slice(0, 160)}...`\n          : props.user.description}\n      className='userCardMeta'\n    />\n  </Card>\n)\n\nexport default UserProfile\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\n// import './style.css'\n\nclass Node extends Component {\n  constructor () {\n    super()\n    this.clickHandler = this.clickHandler.bind(this)\n    this.doubleClickHandler = this.doubleClickHandler.bind(this)\n    this.mouseOverHandler = this.mouseOverHandler.bind(this)\n    this.mouseOutHandler = this.mouseOutHandler.bind(this)\n    // for click vs dblclick\n    this.clickTimeout = null\n  }\n\n  clickHandler () {\n    this.props.onClick({\n      type: 'NODE',\n      data: this.props.id\n    })\n    // if (this.clickTimeout) {\n    //   clearTimeout(this.clickTimeout)\n    //   this.clickTimeout = null\n    //   this.doubleClickHandler()\n    // } else {\n    //   this.clickTimeout = setTimeout(() => {\n    //     if (this.props.onClick) {\n    //       this.props.onClick({\n    //         type: 'NODE',\n    //         data: this.props.id\n    //       })\n    //     }\n    //   }, 300)\n    // }\n  }\n\n  doubleClickHandler () {\n    if (this.props.onDoubleClick) {\n      this.props.onDoubleClick({\n        type: 'NODE',\n        data: this.props.id\n      })\n    }\n  }\n\n  mouseOverHandler (event, x) {\n    if (this.props.onMouseOver) {\n      this.props.onMouseOver({\n        type: 'NODE',\n        data: {\n          id: this.props.id,\n          text: this.props.text,\n          type: this.props.type\n        },\n        event\n      })\n    }\n  }\n\n  mouseOutHandler (event) {\n    if (this.props.onMouseOut) {\n      this.props.onMouseOut({\n        type: 'NODE',\n        data: {\n          id: this.props.id,\n          text: this.props.text,\n          type: this.props.type\n        },\n        event\n      })\n    }\n  }\n\n  render () {\n    const {\n      className,\n      radius,\n      color,\n      x,\n      y,\n      style,\n      active\n    } = this.props\n    return (\n      <g\n        className={className}\n        transform={`translate(${x},${y})`}\n        onClick={this.clickHandler}\n        style={{\n          cursor: 'pointer',\n          opacity: active ? 1 : 0.1\n        }}\n        onMouseOver={this.mouseOverHandler}\n        onMouseOut={this.mouseOutHandler}\n      >\n        <circle\n          r={radius}\n          fill={color}\n          style={style}\n        />\n        {\n          getThumbnail(this.props)\n        }\n      </g>\n    )\n  }\n}\n\nconst getThumbnail = (props) => {\n  const { id, img, radius, shortText, textStyle } = props\n  if (img) {\n    return (\n      <g>\n        <defs>\n          <clipPath\n            id={`clip_${id}`}\n          >\n            <circle\n              r={radius - 1}\n              // fill={bgColor}\n            />\n          </clipPath>\n        </defs>\n        <image\n          xlinkHref={img}\n          clipPath={`url(#clip_${id})`}\n          x={-radius}\n          y={-radius}\n          width={radius * 2}\n        />\n      </g>\n    )\n  } else {\n    return (\n      <text\n        dx={-radius / 2}\n        dy={textStyle.fontSize / 2}\n        style={textStyle}\n      >\n        {shortText}\n      </text>\n    )\n  }\n}\n\nNode.defaultProps = {\n  className: 'node',\n  radius: 35,\n  color: '#FFFFFF',\n  style: {\n    r: 35,\n    stroke: '#375E97',\n    strokeWidth: '3px'\n  },\n  textStyle: {\n    fontSize: 15,\n    fill: '#fff',\n    strokeWidth: '3px',\n    fontWeight: 'normal'\n  },\n  x: 0,\n  y: 0,\n  active: true\n}\n\nNode.propTypes = {\n  id: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  text: PropTypes.string,\n  shortText: PropTypes.string,\n  className: PropTypes.string,\n  img: PropTypes.string,\n  color: PropTypes.string,\n  radius: PropTypes.number,\n  style: PropTypes.shape({\n    r: PropTypes.number,\n    stroke: PropTypes.string,\n    strokeWidth: PropTypes.string\n  }),\n  textStyle: PropTypes.shape({\n    fontSize: PropTypes.number,\n    fill: PropTypes.string,\n    strokeWidth: PropTypes.string,\n    fontWeight: PropTypes.string\n  }),\n  x: PropTypes.number,\n  y: PropTypes.number,\n  onClick: PropTypes.func,\n  onDoubleClick: PropTypes.func,\n  onMouseOut: PropTypes.func,\n  onMouseOver: PropTypes.func,\n  active: PropTypes.bool\n}\n\nexport default Node\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nclass Link extends Component {\n  render () {\n    const { d, pointer, style, id, active } = this.props\n    return (\n      <g\n        style={{\n          opacity: active ? 1 : 0.1\n        }}\n      >\n        { getPointer(this.props) }\n        <path\n          id={id}\n          style={style}\n          d={d}\n          markerEnd={pointer ? `url(#${id}_pointer)` : pointer}\n        />\n        { getLabel(this.props) }\n      </g>\n    )\n  }\n}\n\nconst getPointer = (props) => {\n  if (props.pointer) {\n    return (\n      <defs>\n        <marker\n          id={`${props.id}_pointer`}\n          viewBox='0 -5 10 10'\n          refX={props.arrowOffset}\n          refY='-2'\n          markerWidth='6'\n          markerHeight='6'\n          orient='auto'\n        >\n          <path\n            d='M0,-5L10,0L0,5'\n            fill='#666'\n            style={{\n              opacity: 1\n            }} />\n        </marker>\n      </defs>\n    )\n  }\n}\n\nconst getLabel = (props) => {\n  if (props.type) {\n    return (\n      <text>\n        <textPath\n          dx={0}\n          dy={5}\n          href={`#${props.id}`}\n          startOffset='50%'\n          style={props.textStyle}\n        >\n          {props.type}\n        </textPath>\n      </text>\n    )\n  }\n}\n\nLink.defaultProps = {\n  style: {\n    strokeWidth: 1.5,\n    fill: 'none',\n    stroke: 'gba(50, 50, 50, 0.2)'\n  },\n  textStyle: {\n    pointerEvents: 'none',\n    textAnchor: 'middle',\n    fill: '#333'\n  },\n  pointer: true,\n  active: true\n}\n\nLink.propTypes = {\n  id: PropTypes.string.isRequired,\n  type: PropTypes.string,\n  style: PropTypes.object,\n  textStyle: PropTypes.object,\n  d: PropTypes.string.isRequired,\n  pointer: PropTypes.bool,\n  active: PropTypes.bool\n}\n\nexport default Link\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { scaleOrdinal } from 'd3-scale'\n\nimport Node from '../Node'\nimport Link from '../Link'\n\nclass Universe extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      ...this.props\n    }\n\n    this.getArcPath = this.getArcPath.bind(this)\n    this.getLinks = this.getLinks.bind(this)\n  }\n\n  componentWillReceiveProps (nextProps) {\n    this.setState({ ...nextProps })\n  }\n\n  getLinks (source, target) {\n    return this.state.links\n      .filter(\n        link =>\n          link.source.id === source.id &&\n          link.target.id === target.id\n      )\n      .map(l => l.type)\n  }\n\n  getArcPath (link, clockwise = true) {\n    const x1 = clockwise ? link.source.x : link.target.x\n    const y1 = clockwise ? link.source.y : link.target.y\n    const x2 = clockwise ? link.target.x : link.source.x\n    const y2 = clockwise ? link.target.y : link.source.y\n    const dx = x2 - x1\n    const dy = y2 - y1\n    const siblings = this.getLinks(link.source, link.target)\n    // const siblingCount = siblings.length\n    const siblingCount = 2\n    const xRotation = 0\n    const largeArc = 0\n\n    if (siblingCount > 1) {\n      // console.log(siblings)\n      const arcScale = scaleOrdinal()\n        .domain(siblings)\n        .range([1, siblingCount])\n      const linkIdx = arcScale(link.type)\n      let scale\n      let sweep\n      if (linkIdx === 1) {\n        sweep = 1\n        scale = 1\n        // return `M${link.source.x},${link.source.y} L${link.target.x},${link.target.y}`\n      } else if (linkIdx % 2 === 0) {\n        sweep = 0\n        scale = linkIdx / 2\n      } else if (linkIdx % 3 === 0) {\n        sweep = 1\n        scale = linkIdx / 3 + 1\n      }\n      const dr =\n        Math.sqrt(dx * dx + dy * dy) / (1 + (1 / siblingCount) * (scale - 1))\n      return `M${x1},${y1}A${dr * 1.7},${dr *\n        1.7} ${xRotation}, ${largeArc}, ${sweep} ${x2},${y2}`\n    }\n    return `M${link.source.x},${link.source.y} L${link.target.x},${link.target.y}`\n  }\n\n  render () {\n    const { nodes, links } = this.state\n    return (\n      <g\n        className={this.props.className}\n        transform={this.props.transform}\n      >\n        <g className='links'>\n          {\n            links.reduce((acc, link, idx) => {\n              if (typeof link.source === 'object' && typeof link.target === 'object') {\n                acc.push(\n                  <Link\n                    key={idx}\n                    d={this.getArcPath(link)}\n                    style={link.style}\n                    id={link.id}\n                    type={link.type}\n                    arrowOffset={link.target.radius * 1.45}\n                    active={link.active}\n                  />\n                )\n                return acc\n              }\n              return acc\n            }, [])\n          }\n        </g>\n        <g className='nodes'>\n          {\n            nodes.map((node, idx) =>\n              <Node\n                key={idx}\n                onClick={this.props.onClick}\n                onDoubleClick={this.props.onDoubleClick}\n                onMouseOver={this.props.onMouseOver}\n                onMouseOut={this.props.onMouseOut}\n                {...node}\n              />\n            )\n          }\n        </g>\n      </g>\n    )\n  }\n}\n\nUniverse.defaultProps = {\n  className: 'universe',\n  nodes: [],\n  links: []\n}\n\nUniverse.propTypes = {\n  className: PropTypes.string,\n  nodes: PropTypes.array,\n  links: PropTypes.array,\n  onMouseOver: PropTypes.func,\n  onMouseOut: PropTypes.func\n}\n\nexport default Universe\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { select, event } from 'd3-selection'\nimport {\n  forceLink,\n  forceSimulation,\n  forceCenter,\n  forceManyBody,\n  forceCollide\n} from 'd3-force'\nimport { zoom } from 'd3-zoom'\nimport uniqBy from 'lodash.uniqby'\n\nimport Universe from './components/Universe'\n\nimport './style.css'\n\nclass NetworkGraph extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      nodes: [],\n      links: [],\n      selectedNode: null,\n      activeNodes: [],\n      simulation: this.initSimulation(),\n      width: 100,\n      height: 100,\n      transform: {\n        x: 0,\n        y: 0,\n        k: 1\n      },\n      tooltip: {\n        text: '',\n        style: {\n          opacity: 0,\n          top: 0,\n          left: 0\n        }\n      }\n    }\n    this.initSimulation = this.initSimulation.bind(this)\n    this.initZoomHandler = this.initZoomHandler.bind(this)\n    this.updateSimulation = this.updateSimulation.bind(this)\n    this.onTick = this.onTick.bind(this)\n    this.svg = React.createRef()\n    this.nodes = []\n    this.links = []\n\n    // to timit fps\n    this.interval = (1000 / this.props.fps)\n    this.millis = Date.now()\n\n    // mouseevents\n    this.mouseOverHandler = this.mouseOverHandler.bind(this)\n    this.mouseOutHandler = this.mouseOutHandler.bind(this)\n    this.clickHandler = this.clickHandler.bind(this)\n\n    // graph functions\n    this.getNeighborNodes = this.getNeighborNodes.bind(this)\n  }\n\n  componentDidMount () {\n    this.initZoomHandler()\n    this.setState({\n      ...this.props,\n      width: this.svg.current.clientWidth,\n      height: this.svg.current.clientHeight\n    }, () => {\n      this.updateSimulation()\n    })\n  }\n\n  componentWillReceiveProps (newProps) {\n    this.setState({\n      ...newProps\n    }, () => {\n      this.interval = (1000 / this.state.fps)\n      this.updateSimulation()\n    })\n  }\n\n  initSimulation () {\n    const linkForce = forceLink()\n      .id(link => link.id)\n      .strength(link => link.strength)\n      .distance(link => link.distance)\n    const simulation = forceSimulation().force('link', linkForce)\n\n    return simulation\n  }\n\n  initZoomHandler () {\n    // TODO: replace select dependency\n    // add zoom capabilities\n    const svg = select('.svgGraph')\n    const zoomHandler = zoom().on('zoom', () => {\n      this.setState({\n        transform: event.transform\n      })\n    })\n    svg.call(zoomHandler).on('dblclick.zoom', null)\n  }\n\n  updateSimulation () {\n    const {\n      nodes,\n      links,\n      simulation,\n      width,\n      height,\n      attraceForceStrength,\n      chargeStrength,\n      collisionRadiusOffset,\n      collisionStrength,\n      animation,\n      velocityDecay,\n      alphaStart,\n      cluster,\n      clusterRadiusScale\n    } = this.state\n\n    this.nodes = nodes\n    this.links = []\n\n    // bind nodes to links\n    links.forEach(link => {\n      const sourceNode = this.nodes.filter(\n        node => node.id === link.source\n      )[0]\n      const targetNode = this.nodes.filter(\n        node => node.id === link.target\n      )[0]\n      if (sourceNode && targetNode) {\n        this.links.push({\n          ...link,\n          source: sourceNode,\n          target: targetNode\n        })\n      }\n    })\n    simulation\n      .nodes(this.nodes)\n      .on('tick', this.onTick)\n    simulation.force('link').links(this.links)\n    simulation\n      .force('center', forceCenter(width / 2, height / 2))\n      .force('attraceForce', forceManyBody().strength(attraceForceStrength))\n      .force('charge', forceManyBody().strength(chargeStrength))\n      .force(\n        'collision',\n        forceCollide()\n          .radius(node => node.radius + collisionRadiusOffset)\n          .strength(collisionStrength)\n      )\n\n    // Enable clustering of nodes of same type\n    if (cluster) {\n      const clusters = {}\n      const nodeTypes = uniqBy(this.nodes, 'type').map(type => type.type)\n\n      nodeTypes.forEach((type, idx, arr) => {\n        if (!clusters[type]) {\n          const radius = width > height ? height * clusterRadiusScale : width * clusterRadiusScale\n          clusters[type] = {\n            x: Math.cos((idx + 1) / arr.length * 2 * Math.PI) * radius + width / 2 + Math.random(),\n            y: Math.sin((idx + 1) / arr.length * 2 * Math.PI) * radius + height / 2 + Math.random(),\n            radius\n          }\n        }\n      })\n\n      simulation.force('cluster', alpha =>\n        applyClusterForce(alpha, this.nodes, clusters)\n      )\n    } else {\n      simulation.force('cluster', null)\n    }\n\n    simulation\n      .alpha(alphaStart)\n      .alphaTarget(0)\n      .velocityDecay(velocityDecay)\n      .restart()\n\n    if (!animation) {\n      while (simulation.alpha() >= 0.02) {\n        simulation.tick()\n      }\n    }\n  }\n\n  onTick (e) {\n    // limit rendering\n    const currentTime = Date.now()\n    if (currentTime - this.millis > this.interval) {\n      this.millis = currentTime\n      this.setState({\n        nodes: this.nodes,\n        links: this.links\n      })\n    }\n  }\n\n  mouseOutHandler () {\n    this.setState({\n      tooltip: {\n        style: {\n          opacity: 0\n        }\n      }\n    })\n  }\n\n  mouseOverHandler (payload) {\n    const { event, type, data } = payload\n    let text = ''\n    if (type === 'NODE') {\n      text = `[${data.type}] ${data.text}`\n    } else if (type === 'LINK') {\n      text = `${data.type}`\n    }\n    this.setState({\n      tooltip: {\n        text,\n        style: {\n          opacity: 1,\n          top: event.clientY + 15,\n          left: event.clientX + 15\n        }\n      }\n    })\n  }\n\n  clickHandler (event) {\n    if (this.state.selectedNode === event.data) {\n      this.setState({\n        selectedNode: null,\n        activeNodes: []\n      })\n    } else {\n      this.setState({\n        selectedNode: event.data,\n        activeNodes: this.getNeighborNodes(event.data)\n      })\n    }\n  }\n\n  getNeighborNodes (node) {\n    return this.links.reduce(\n      (neighbors, link) => {\n        if (link.target.id === node) {\n          neighbors.push(link.source.id)\n        } else if (link.source.id === node) {\n          neighbors.push(link.target.id)\n        }\n        return neighbors\n      },\n      []\n    )\n  }\n\n  render () {\n    const { transform, tooltip, selectedNode, activeNodes } = this.state\n\n    // determine opacity of node / link based on if its selected or not\n    const nodes = this.state.nodes.map(node => ({\n      ...node,\n      active: selectedNode === null || node.id === selectedNode || activeNodes.indexOf(node.id) > -1\n    }))\n\n    const links = this.state.links.map(link => ({\n      ...link,\n      active:\n        selectedNode === null\n        || link.source.id === selectedNode\n        || link.target.id === selectedNode\n    }))\n\n    return (\n      <div\n        className='networkGraph'\n        style={{\n          width: '100%',\n          height: '100%'\n        }}\n      >\n        <svg\n          className='svgGraph'\n          width='100%'\n          height='100%'\n          ref={this.svg}\n        >\n          <Universe\n            nodes={nodes}\n            links={links}\n            transform={\n              `translate(${transform.x},${transform.y}) scale(${transform.k})`\n            }\n            onClick={this.clickHandler}\n            onDoubleClick={this.props.onDoubleClick}\n            onMouseOver={this.mouseOverHandler}\n            onMouseOut={this.mouseOutHandler}\n          />\n        </svg>\n        {/* <span className='zoomIndicator'>{parseInt(transform.k * 100, 10)} %</span> */}\n        <span\n          className='networkGrapTooltip'\n          style={tooltip.style}\n        >\n          {tooltip.text}\n        </span>\n      </div>\n    )\n  }\n}\n\n// node cluster handler\nconst applyClusterForce = (alpha, nodes, clusters) => {\n  nodes.forEach(node => {\n    const cluster = clusters[node.type]\n    if (cluster.x !== node.x && cluster.y !== node.y) {\n      const k = alpha * 0.5\n      node.vx -= (node.x - cluster.x) * k\n      node.vy -= (node.y - cluster.y) * k\n    }\n  })\n}\n\nNetworkGraph.defaultProps = {\n  nodes: [],\n  links: [],\n  attraceForceStrength: 10,\n  chargeStrength: -10,\n  collisionRadiusOffset: 15,\n  collisionStrength: 0.5,\n  animation: true,\n  cluster: false,\n  fps: 60,\n  alphaStart: 1,\n  velocityDecay: 0.4,\n  clusterRadiusScale: 2\n}\n\nNetworkGraph.propTypes = {\n  nodes: PropTypes.array,\n  links: PropTypes.array,\n  attraceForceStrength: PropTypes.number,\n  chargeStrength: PropTypes.number,\n  collisionRadiusOffset: PropTypes.number,\n  collisionStrength: PropTypes.number,\n  animation: PropTypes.bool,\n  fps: PropTypes.number,\n  alphaStart: PropTypes.number,\n  velocityDecay: PropTypes.number,\n  onClick: PropTypes.func,\n  onDoubleClick: PropTypes.func,\n  cluster: PropTypes.bool,\n  clusterRadiusScale: PropTypes.number\n}\n\nexport default NetworkGraph\n","import React from 'react'\nimport LazyLoad from 'react-lazyload'\n\nconst style = {\n  backgroundColor: '#eee',\n  cursor: 'pointer',\n  overflow: 'hidden',\n  position: 'relative'\n}\n\nconst imgStyle = {\n  transition: 'transform .135s cubic-bezier(0.0,0.0,0.2,1),opacity linear .15s'\n}\n\nconst BookCover = ({\n  index,\n  onClick,\n  photo,\n  margin,\n  direction,\n  top,\n  left\n}) => {\n  if (direction === 'column') {\n    style.position = 'absolute'\n    style.left = left\n    style.top = top\n  }\n  return (\n    <div\n      style={{ margin, height: photo.height, width: photo.width, ...style }}\n      className='lazy-image'\n    >\n      <LazyLoad\n        overflow\n      >\n        <img\n          style={\n            { ...imgStyle }\n          }\n          {...photo}\n          onClick={e => onClick(e, { index, photo })}\n          alt={photo.alt}\n          title={photo.alt}\n        />\n      </LazyLoad>\n    </div>\n  )\n}\n\nexport default BookCover\n","import React from 'react'\nimport Gallery from 'react-photo-gallery'\nimport BookCover from '../BookCover'\n\nconst BookLibrary = (props) => (\n  <Gallery\n    photos={\n      props.books.map((book, idx) => ({\n        // ...book,\n        src: book.small_image_url.replace(/.(s\\/)/g, str => {\n          const tmp = str.split('s/')\n          if (tmp[0] < 58) {\n            return tmp[0].concat('l/')\n          }\n          return str\n        }),\n        width: 98,\n        height: 148,\n        alt: book.title,\n        key: book.title\n      }))\n    }\n    onClick={\n      (event, obj) => {\n        window.open(obj.photo.link, '_blank')\n      }\n    }\n    direction='column'\n    margin={props.margin}\n    columns={props.columns}\n    ImageComponent={BookCover}\n  />\n)\n\nexport default BookLibrary\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { Checkbox, Slider, Button, Tooltip } from 'antd'\n\nimport './style.css'\n\nconst CheckboxGroup = Checkbox.Group\n\nconst plainOptions = ['animation', 'cluster']\n\nclass Settings extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      ...props\n    }\n\n    this.defaultOptions = plainOptions.filter((option) => this.props.settings[option])\n\n    this.updateState = this.updateState.bind(this)\n\n    // settings handler\n    this.updateFps = this.updateFps.bind(this)\n    this.updateCluster = this.updateCluster.bind(this)\n    this.updateAnimation = this.updateAnimation.bind(this)\n    this.updateAlphaStart = this.updateAlphaStart.bind(this)\n    this.updateVelocityDecay = this.updateVelocityDecay.bind(this)\n    this.updateChargeStrength = this.updateChargeStrength.bind(this)\n    this.updateCollisionStrength = this.updateCollisionStrength.bind(this)\n    this.updateClusterRadiusScale = this.updateClusterRadiusScale.bind(this)\n    this.updateCollisionRadiusOffset = this.updateCollisionRadiusOffset.bind(this)\n    this.updateAttracForceStrength = this.updateAttracForceStrength.bind(this)\n  }\n\n  updateState (val) {\n    // update local state and trigger parent onChange function\n    this.setState({\n      settings: {\n        ...this.state.settings,\n        ...val\n      }\n    },\n    () => this.props.onChange(this.state.settings))\n  }\n\n  updateFps (val) {\n    this.updateState({\n      fps: val\n    })\n  }\n\n  updateCluster (val) {\n    this.updateState({\n      cluster: val\n    })\n  }\n\n  updateAnimation (val) {\n    this.updateState({\n      animation: val\n    })\n  }\n\n  updateAlphaStart (val) {\n    this.updateState({\n      alphaStart: val\n    })\n  }\n\n  updateVelocityDecay (val) {\n    this.updateState({\n      velocityDecay: val\n    })\n  }\n\n  updateChargeStrength (val) {\n    this.updateState({\n      chargeStrength: val\n    })\n  }\n\n  updateCollisionStrength (val) {\n    this.updateState({\n      collisionStrength: val\n    })\n  }\n\n  updateClusterRadiusScale (val) {\n    this.updateState({\n      clusterRadiusScale: val\n    })\n  }\n\n  updateCollisionRadiusOffset (val) {\n    this.updateState({\n      collisionRadiusOffset: val\n    })\n  }\n\n  updateAttracForceStrength (val) {\n    this.updateState({\n      attraceForceStrength: val\n    })\n  }\n\n  render () {\n    const {\n      fps,\n      alphaStart,\n      velocityDecay,\n      attraceForceStrength,\n      collisionStrength,\n      collisionRadiusOffset,\n      clusterRadiusScale,\n      chargeStrength\n    } = this.state.settings\n\n    // this.props.onChange(this.state)\n\n    return (\n      <div\n        className='settings'\n      >\n        <ul>\n          <li>\n            <div style={{ borderBottom: '1px solid #E9E9E9', padding: 5 }}>\n              <CheckboxGroup\n                options={plainOptions}\n                value={this.defaultOptions}\n                onChange={(checked) => {\n                  this.defaultOptions = checked\n                  this.updateState({\n                    animation: checked.indexOf('animation') > -1,\n                    cluster: checked.indexOf('cluster') > -1\n                  })\n                }}\n                className='settingsCheckbox'\n              />\n            </div>\n          </li>\n          <li>\n            <Tooltip title='How many times per second to render the graph.' placement='rightTop'>\n              FPS ({fps})\n            </Tooltip>\n            <Slider\n              defaultValue={fps}\n              max={120}\n              min={1}\n              step={1}\n              onAfterChange={this.updateFps}\n            />\n          </li>\n          <li>\n            <Tooltip title='Initial Alpha of simulation.' placement='rightTop'>\n              Alpha Start ({alphaStart})\n            </Tooltip>\n            <Slider\n              defaultValue={alphaStart}\n              max={1}\n              min={0}\n              step={0.01}\n              onAfterChange={this.updateAlphaStart}\n            />\n          </li>\n          <li>\n            <Tooltip\n              title='The decay factor is akin to atmospheric friction; after the application of any forces during a tick, each node’s velocity is multiplied by 1 - decay. As with lowering the alpha decay rate, less velocity decay may converge on a better solution, but risks numerical instabilities and oscillation.'\n              placement='rightTop'\n            >\n              velocity Decay ({velocityDecay})\n            </Tooltip>\n            <Slider\n              defaultValue={velocityDecay}\n              max={1}\n              min={0}\n              step={0.01}\n              onAfterChange={this.updateVelocityDecay}\n            />\n          </li>\n          <li>\n            <Tooltip title='It can be used to simulate gravity (attraction) if the strength is positive, or electrostatic charge (repulsion) if the strength is negative.' placement='rightTop'>\n              Charge Strength ({chargeStrength})\n            </Tooltip>\n            <Slider\n              defaultValue={chargeStrength}\n              max={500}\n              min={-500}\n              step={1}\n              onAfterChange={this.updateChargeStrength}\n            />\n          </li>\n          <li>\n            <Tooltip title='Sets the collision force strength to the specified number.' placement='rightTop'>\n              Collision Strength ({collisionStrength})\n            </Tooltip>\n            <Slider\n              defaultValue={collisionStrength}\n              max={1}\n              min={0}\n              step={0.01}\n              onAfterChange={this.updateCollisionStrength}\n            />\n          </li>\n          <li>\n            <Tooltip title='The collision force treats nodes as circles with a given radius, rather than points, and prevents nodes from overlapping.' placement='rightTop'>\n              Collision Radius Offset ({collisionRadiusOffset})\n            </Tooltip>\n            <Slider\n              defaultValue={collisionRadiusOffset}\n              max={50}\n              min={0}\n              step={1}\n              onAfterChange={this.updateCollisionRadiusOffset}\n            />\n          </li>\n          <li>\n            <Tooltip title='Sets attractive force strength between nodes' placement='rightTop'>\n              Attractive Force Strength ({attraceForceStrength})\n            </Tooltip>\n            <Slider\n              defaultValue={attraceForceStrength}\n              max={500}\n              min={-500}\n              step={1}\n              onAfterChange={this.updateAttracForceStrength}\n            />\n          </li>\n          <li>\n            <Tooltip title='Radius of the circle around which to cluster the nodes.' placement='rightTop'>\n              Cluster Radius Scale ({clusterRadiusScale})\n            </Tooltip>\n            <Slider\n              defaultValue={clusterRadiusScale}\n              max={10}\n              min={0.5}\n              step={0.5}\n              onAfterChange={this.updateClusterRadiusScale}\n            />\n          </li>\n          <div\n            style={{\n              padding: 10\n            }}\n          >\n            <Button\n              type='danger'\n              onClick={() => this.props.onReset()}\n              block\n            >\n              Reset\n            </Button>\n          </div>\n        </ul>\n      </div>\n    )\n  }\n}\n\nSettings.defaultProps = {\n  settings: {\n    fps: 60,\n    cluster: true,\n    alphaStart: 1,\n    animation: true,\n    velocityDecay: 0.1,\n    chargeStrength: -100,\n    clusterRadiusScale: 2,\n    collisionStrength: 0.5,\n    collisionRadiusOffset: 15,\n    attraceForceStrength: -100\n  }\n}\n\nSettings.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  onReset: PropTypes.func.isRequired,\n  settings: PropTypes.shape({\n    fps: PropTypes.number,\n    cluster: PropTypes.bool,\n    alphaStart: PropTypes.number,\n    animation: PropTypes.bool,\n    velocityDecay: PropTypes.number,\n    chargeStrength: PropTypes.number,\n    clusterRadiusScale: PropTypes.number,\n    collisionStrength: PropTypes.number,\n    collisionRadiusOffset: PropTypes.number,\n    attraceForceStrength: PropTypes.number\n  })\n}\n\nexport default Settings\n","import React, { Component } from 'react'\n\nclass ErrorBoundary extends Component {\n  constructor (props) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch (error, info) {\n    // You can also log the error to an error reporting service\n    // logErrorToMyService(error, info)\n    console.log('Error', error, info)\n  }\n\n  render () {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return <h1>Something went wrong.</h1>\n    }\n\n    return this.props.children\n  }\n}\n\nexport default ErrorBoundary\n","const minifyString = text => {\n  return text.split(' ').slice(0, 3).map(word => word.charAt(0).toUpperCase()).join('')\n}\n\nexport function getGraphData (userData, shelves) {\n  let books = []\n  let bookNodes = {}\n  let authorNodes = {}\n  let publisherNodes = {}\n  let nodes = []\n  let links = []\n\n  const bookShelves = userData.user_shelves\n\n  // nodes.push({\n  //   text: userData.name,\n  //   id: userData.id,\n  //   img: userData.image_url,\n  //   type: 'USER',\n  //   color: '#336B87',\n  //   radius: 55,\n  //   style: {\n  //     r: 55,\n  //     stroke: '#375E97',\n  //     strokeWidth: '3px'\n  //   }\n  // })\n\n  bookShelves.forEach(shelf => {\n    if (shelves.indexOf(shelf.name) > -1) {\n      if (shelf.books.book) {\n        const tmpList = shelf.books.book.length ? shelf.books.book : [ shelf.books.book ]\n        tmpList.forEach(book => {\n          books.push(\n            {\n              ...book,\n              property: {\n                shelf: shelf.name\n              }\n            }\n          )\n        })\n      }\n    }\n  })\n\n  books.forEach(book => {\n    const { author } = book.authors\n\n    if (!bookNodes[book.id.$t]) {\n      // Create Book Nodes\n      bookNodes[book.id.$t] = {\n        id: book.id.$t,\n        text: book.title,\n        type: 'BOOK',\n        img: book.image_url,\n        color: '#336B87',\n        radius: 35,\n        style: {\n          r: 35,\n          stroke: '#375E97',\n          strokeWidth: '3px'\n        }\n      }\n      // Create Author Nodes\n      if (!authorNodes[author.id]) {\n        authorNodes[author.id] = {\n          id: author.id,\n          text: author.name,\n          type: 'AUTHOR',\n          img: author.image_url.$t,\n          color: '#FB6542',\n          radius: 35,\n          style: {\n            r: 35,\n            stroke: '#FB6542',\n            strokeWidth: '3px'\n          }\n        }\n      }\n      // Create Publisher Nodes\n      if (!publisherNodes[book.publisher]) {\n        publisherNodes[book.publisher] = {\n          id: typeof book.publisher === 'string' ? book.publisher : 'Self Published',\n          text: typeof book.publisher === 'string' ? book.publisher : 'Self Published',\n          type: 'PUBLISHER',\n          color: '#DDA487',\n          radius: 35,\n          style: {\n            r: 35,\n            stroke: '#7D4427',\n            strokeWidth: '3px'\n          }\n        }\n      }\n      // Create Authoer --> Book relationship\n      links.push({\n        source: author.id,\n        sourceType: 'AUTHOR',\n        target: book.id.$t,\n        targetType: 'BOOK',\n        type: 'AUTHOR_OF',\n        property: {\n          publicationYear: book.publication_year,\n          publicationMonth: book.publication_month,\n          publicationDay: book.publication_day\n        }\n      })\n      // Create Book --> Publisher relationship\n      links.push({\n        source: book.id.$t,\n        sourceType: 'BOOK',\n        target: typeof book.publisher === 'string' ? book.publisher : 'Self Published',\n        targetType: 'PUBLISHER',\n        type: 'PUBLISHED_BY',\n        property: {\n          publicationYear: book.publication_year,\n          publicationMonth: book.publication_month,\n          publicationDay: book.publication_day\n        }\n      })\n\n      // Create Author --> Publisher relationship\n      links.push({\n        source: author.id,\n        sourceType: 'AUTHOR',\n        target: book.publisher,\n        targetType: 'PUBLISHER',\n        type: 'WORKS_WITH',\n        property: {\n          publicationYear: book.publication_year,\n          publicationMonth: book.publication_month,\n          publicationDay: book.publication_day\n        }\n      })\n    }\n  })\n\n  // Collect all nodes\n  nodes = Object.values(bookNodes)\n    .concat(Object.values(authorNodes))\n    .concat(Object.values(publisherNodes))\n    .map((node, idx) => ({\n      ...node,\n      shortText: minifyString(node.text),\n      textStyle: {\n        fontSize: 15,\n        fill: '#fff',\n        strokeWidth: '2px',\n        fontWeight: 'normal'\n      }\n    }))\n\n  return {\n    nodes,\n    links: links.map(link => ({\n      ...link,\n      strength: 0.5,\n      distance: 350,\n      id: `${link.source}-${link.type}-${link.target}`,\n      style: {\n        strokeWidth: 1.5,\n        fill: 'none',\n        stroke: 'rgba(50, 50, 50, 0.2)'\n      }\n    }))\n  }\n}\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport { getUserInfo, getUserData } from './action'\n\n// antd components\nimport { Layout, Menu, Breadcrumb, Icon, Tree } from 'antd'\n\nimport UserProfile from '../../components/UserProfile'\nimport NetworkGraph from '../../components/NetworkGraph'\nimport BookLibrary from '../../components/BookLibrary'\nimport Settings from '../../components/Settings'\nimport ErrorBoundary from '../../components/ErrorBoundary'\n\nimport { getGraphData } from '../../utils/graphHelper'\n\nimport bgImage from '../../components/NetworkGraph/examples/basic/tiny_grid.png'\n// import goodReadsLogo from '../../assets/images/goodreads-logo-transparent.png'\nimport goodReadsLogo from '../../assets/images/good_reads_explorer.png'\n\nimport './style.css'\n\nconst { SubMenu } = Menu\nconst { Content, Sider } = Layout\nconst { TreeNode } = Tree\n\nconst mapStorageToProps = state => ({\n  userInfo: state.dashboard.userInfo,\n  userData: state.dashboard.userData\n})\n\nconst mapDispatchToProps = {\n  getUserInfo,\n  getUserData\n}\n\nconst defaultGraphSettings = {\n  fps: 60,\n  cluster: true,\n  alphaStart: 1,\n  animation: true,\n  velocityDecay: 0.1,\n  chargeStrength: -100,\n  collisionStrength: 0.5,\n  collisionRadiusOffset: 15,\n  attraceForceStrength: -100,\n  clusterRadiusScale: 2\n}\n\nclass Dashboard extends Component {\n  constructor (props) {\n    super(props)\n\n    // get graph settings from localstorage\n    const settings = window.localStorage.getItem('graphSettings')\n\n    this.state = {\n      selectedShelf: null,\n      selectedShelves: [],\n      selectedMenu: 0,\n      graphSettings: settings ? JSON.parse(settings) : defaultGraphSettings\n    }\n    console.log('Init Settings', this.state.graphSettings)\n    this.onSelect = this.onSelect.bind(this)\n    this.onCheck = this.onCheck.bind(this)\n    this.onSettingsChange = this.onSettingsChange.bind(this)\n    this.onSettingsReset = this.onSettingsReset.bind(this)\n  }\n\n  componentDidMount () {\n    this.props.getUserData(this.props.match.params.userId)\n  }\n\n  onSelect (selectedKeys, info) {\n    console.log('selected', selectedKeys, info)\n  }\n\n  onCheck (checkedKeys, info) {\n    console.log('onCheck', checkedKeys, info)\n    this.setState({\n      selectedShelves: checkedKeys\n    })\n  }\n\n  onSettingsChange (settings) {\n    this.setState({\n      graphSettings: settings\n    })\n    // Store settings on local storage\n    window.localStorage.setItem('graphSettings', JSON.stringify(settings))\n  }\n\n  onSettingsReset () {\n    this.setState({\n      graphSettings: defaultGraphSettings\n    })\n\n    // clear settings on local storage\n    window.localStorage.removeItem('graphSettings')\n    window.location.reload()\n  }\n\n  render () {\n    const { userData } = this.props\n    // console.log(userData)\n    return (\n      <ErrorBoundary>\n        <Layout\n          className='dashboard'\n        >\n          <Layout>\n            <Sider className='sider' width={270} >\n              <div className='logo' style={{\n                padding: '10px',\n                background: '#fff'\n              }}>\n                <Link to={'/'}>\n                  <img\n                    src={goodReadsLogo}\n                    width='250px'\n                    alt='Goodreads'\n                  />\n                </Link>\n              </div>\n              {\n                getUserComponent(userData)\n              }\n              {\n                getMenu(this)\n              }\n            </Sider>\n            <Layout style={{ padding: '0 24px 24px' }}>\n              <Breadcrumb style={{ margin: '16px 0' }}>\n                <Breadcrumb.Item>Home</Breadcrumb.Item>\n                <Breadcrumb.Item>User</Breadcrumb.Item>\n                <Breadcrumb.Item>Books</Breadcrumb.Item>\n              </Breadcrumb>\n              <Content\n                className='mainContent'\n                style={{\n                  backgroundImage: { bgImage }, padding: 0, margin: 0, height: '100%'\n                }}\n              >\n                { getContent(this) }\n              </Content>\n            </Layout>\n          </Layout>\n        </Layout>\n      </ErrorBoundary>\n    )\n  }\n}\n\nconst getContent = (context) => {\n  const { selectedMenu, selectedShelf, graphSettings } = context.state\n  const { userData } = context.props\n  if (context.props.userData) {\n    if (selectedMenu === 0) {\n      const { nodes, links } = getGraphData(context.props.userData, context.state.selectedShelves)\n      return (\n        <NetworkGraph\n          nodes={nodes}\n          links={links}\n          {...graphSettings}\n        />\n      )\n    } else if (selectedMenu === 1) {\n      return getBookLibrary(userData, selectedShelf)\n    }\n  }\n}\n\nconst getUserComponent = (userData) => {\n  if (userData) {\n    return (\n      <UserProfile\n        user={{\n          name: userData.name || '',\n          userName: userData.user_name || '',\n          image: userData.image_url || '',\n          link: userData.link,\n          description: typeof userData.about === 'string' ? userData.about : `Last active: ${userData.last_active}`\n        }}\n      />\n    )\n  }\n  return (\n    <UserProfile\n      user={{\n        name: '',\n        userName: '',\n        image: '',\n        description: ''\n      }}\n    />\n  )\n}\n\nconst getMenu = (context) => {\n  const { userData } = context.props\n  if (userData) {\n    console.log(userData)\n    return (\n      <Menu\n        mode='inline'\n        defaultOpenKeys={['shelves']}\n        style={{\n          // height: '100%',\n          borderRight: 0\n        }}\n        theme='light'\n        // selectable\n      >\n        <SubMenu\n          key='shelves'\n          title={\n            <span><Icon type='book' />Shelves</span>\n          }\n        >\n          <Tree\n            checkable\n            onSelect={context.onSelect}\n            onCheck={context.onCheck}\n            className='shelves'\n          >\n            {\n              userData.user_shelves.map(shelf => {\n                if (shelf.books.book) {\n                  const books = shelf.books.book.length ? shelf.books.book : [shelf.books.book]\n                  return (\n                    <TreeNode\n                      title={`${shelf.name} (${books.length})`}\n                      key={shelf.name}\n                      className='booksList'\n                    >\n                      {\n                        books.map((book, idx) => {\n                          return (\n                            <TreeNode\n                              title={`${book.title} (${book.published})`}\n                              key={`${idx}_${book.title}`}\n                              disableCheckbox\n                            />\n                          )\n                        })\n                      }\n                    </TreeNode>\n                  )\n                }\n                return (\n                  <TreeNode\n                    title={`${shelf.name} (0)`}\n                    key={shelf.name}\n                    disabled\n                  />\n                )\n              })\n            }\n          </Tree>\n        </SubMenu>\n        <SubMenu\n          key='settings'\n          title={<span><Icon type='setting' />Settings</span>}\n        >\n          <Settings\n            onChange={context.onSettingsChange}\n            onReset={context.onSettingsReset}\n            settings={context.state.graphSettings}\n          />\n          {/* {\n            userData.user_shelves.map((shelf, idx) => (\n              <Menu.Item key={idx}>\n                <Link to={`/user/${userData.id}/shelf/${shelf.name}`}>\n                  {`${shelf.name} (${shelf.books.book ? shelf.books.book.length || 1 : 0})`}\n                </Link>\n              </Menu.Item>\n            ))\n          } */}\n        </SubMenu>\n      </Menu>\n    )\n  }\n}\n\nconst getBookLibrary = (userData, shelf) => {\n  if (userData) {\n    let bookShelf = userData.user_shelves.find(sh => sh.name === shelf)\n    if (bookShelf) {\n      let { books } = bookShelf\n      if (!books.book) return <div />\n      books = books.book.length ? books.book : [ books.book ]\n      return (\n        <div\n          style={{\n            width: '100%',\n            height: '100%',\n            overflow: 'auto'\n          }}\n        >\n          <BookLibrary\n            books={books}\n            margin={0}\n            columns={7}\n          />\n        </div>\n      )\n    }\n    return (\n      <div\n        style={{\n          padding: 20\n        }}\n      >\n        <p>Bookshelf doesn't exist.</p>\n      </div>\n    )\n  }\n  return <div />\n}\n\nexport default connect(\n  mapStorageToProps,\n  mapDispatchToProps\n)(Dashboard)\n"],"sourceRoot":""}